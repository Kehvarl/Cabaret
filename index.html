<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Cabaret</title>
  <meta name="description" content="Cabaret Chat Project">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Cabaret">
  <meta property="og:type" content="chat platform">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link type="text/plain" rel="author" href="/humans.txt" />

  <meta name="theme-color" content="#fafafa">

  <link rel='stylesheet' href='style/style.css' type='text/css'/>

  <script>
    function get_posts()
    {
      fetch('api.php/load')
              .then(res => res.json())
              .then((out) => {
                render_posts(out);
              }).catch(err => console.error(err));

      setTimeout(function(){get_posts()}, 2.0*1000);
    }

    function render_posts(room_data)
    {
      //document.getElementById("posts").innerHTML = "";
      room_data['posts'].forEach((p)=>
      {
        $ret = "<div class='post' style='color: "+p['color']+"'>";
        $ret += "<span class='name'>"+p['display_name']+"</span> ";
        $ret += "<span class='message'>"+p['message']+"</span> ";
        $ret += "<span class='time'>"+p['date_time']+"</span></div>";
        document.getElementById("posts").innerHTML += $ret;
      });
    }

    get_posts();
  </script>
</head>

<body>

  <div id="posts" class="posts">
  </div>


</body>

</html>
